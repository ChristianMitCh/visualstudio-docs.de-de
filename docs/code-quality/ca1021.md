---
title: 'CA1021: out-Parameter vermeiden'
ms.date: 11/04/2016
ms.topic: reference
f1_keywords:
- CA1021
- AvoidOutParameters
helpviewer_keywords:
- AvoidOutParameters
- CA1021
ms.assetid: 970f2304-842c-4fb7-9734-f3871da8d479
author: mikejo5000
ms.author: mikejo
manager: jillfra
ms.workload:
- multiple
ms.openlocfilehash: 579b04f26af972ac025b0bfc07bc8dc9eb636d12
ms.sourcegitcommit: 98421670ed0b8170aaa32d3d6f8681298f401a1d
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 04/18/2020
ms.locfileid: "81638034"
---
# <a name="ca1021-avoid-out-parameters"></a>CA1021: out-Parameter vermeiden

|||
|-|-|
|TypName|AvoidOutParameters|
|CheckId|CA1021|
|Category|Microsoft.Design|
|Unterbrechende Änderung|Breaking|

## <a name="cause"></a>Ursache
Eine öffentliche oder geschützte Methode in `out` einem öffentlichen Typ verfügt über einen Parameter.

Standardmäßig betrachtet diese Regel nur extern sichtbare Typen, aber diese ist [konfigurierbar.](#configurability)

## <a name="rule-description"></a>Regelbeschreibung
Das Übergeben von `out` Typen `ref`nach Verweis (Verwendung oder ) erfordert Erfahrung mit Zeigern, Das Verständnis, wie sich Werttypen und Verweistypen unterscheiden, und die Handhabung von Methoden mit mehreren Rückgabewerten. Auch der Unterschied `out` `ref` zwischen und Parametern ist nicht allgemein verstanden.

Wenn ein Verweistyp "durch Verweis" übergeben wird, beabsichtigt die Methode, den Parameter zu verwenden, um eine andere Instanz des Objekts zurückzugeben. Das Übergeben eines Verweistyps als Verweis wird auch als Verwendung eines doppelten Zeigers, Zeigers auf einen Zeiger oder einer doppelten Indirektion bezeichnet. Mithilfe der Standardaufrufkonvention, die "by value" übergeben wird, erhält ein Parameter, der einen Verweistyp annimmt, bereits einen Zeiger auf das Objekt. Der Zeiger, nicht das Objekt, auf das er zeigt, wird durch den Wert übergeben. Pass by-Wert bedeutet, dass die Methode den Zeiger nicht so ändern kann, dass er auf eine neue Instanz des Verweistyps verweist. Es kann jedoch den Inhalt des Objekts ändern, auf das es verweist. Für die meisten Anwendungen ist dies ausreichend und ergibt das gewünschte Verhalten.

Wenn eine Methode eine andere Instanz zurückgeben muss, verwenden Sie den Rückgabewert der Methode, um dies zu erreichen. In <xref:System.String?displayProperty=fullName> der Klasse finden Sie eine Vielzahl von Methoden, die auf Zeichenfolgen ausgeführt werden, und geben eine neue Instanz einer Zeichenfolge zurück. Wenn dieses Modell verwendet wird, muss der Aufrufer entscheiden, ob das ursprüngliche Objekt beibehalten wird.

Obwohl Rückgabewerte an der Tagesordnung sind und `out` `ref` häufig verwendet werden, erfordert die korrekte Anwendung und Parameter Zwischenentwurfs- und Codierungsfertigkeiten. Bibliotheksarchitekten, die für eine allgemeine Zielgruppe entwerfen, sollten nicht erwarten, dass Benutzer die Arbeit mit `out` oder `ref` Parameter beherrschen.

## <a name="how-to-fix-violations"></a>Behandeln von Verstößen
Um eine Verletzung dieser Regel zu beheben, die durch einen Werttyp verursacht wird, lassen Sie die Methode das Objekt als Rückgabewert zurückgeben. Wenn die Methode mehrere Werte zurückgeben muss, entwerfen Sie sie neu, um eine einzelne Instanz eines Objekts zurückzugeben, das die Werte enthält.

Um eine Verletzung dieser Regel zu beheben, die durch einen Verweistyp verursacht wird, stellen Sie sicher, dass das gewünschte Verhalten darin besteht, eine neue Instanz des Verweises zurückzugeben. Wenn dies der Grund ist, sollte die Methode dazu ihren Rückgabewert verwenden.

## <a name="when-to-suppress-warnings"></a>Wann Warnungen unterdrückt werden sollen
Es ist sicher, eine Warnung aus dieser Regel zu unterdrücken. Dieses Design kann jedoch zu Usability-Problemen führen.

## <a name="configurability"></a>Konfigurierbarkeit

Wenn Sie diese Regel von [FxCop-Analysatoren](install-fxcop-analyzers.md) (und nicht mit Legacyanalyse) ausführen, können Sie basierend auf ihrer Zugänglichkeit konfigurieren, auf welchen Teilen ihrer Codebasis diese Regel ausgeführt werden soll. Um beispielsweise anzugeben, dass die Regel nur für die nicht öffentliche API-Oberfläche ausgeführt werden soll, fügen Sie der .editorconfig-Datei in Ihrem Projekt das folgende Schlüssel-Wert-Paar hinzu:

```ini
dotnet_code_quality.ca1021.api_surface = private, internal
```

Sie können diese Option nur für diese Regel, für alle Regeln oder für alle Regeln in dieser Kategorie (Entwurf) konfigurieren. Weitere Informationen finden Sie unter Konfigurieren von [FxCop-Analysatoren](configure-fxcop-analyzers.md).

## <a name="example"></a>Beispiel
Die folgende Bibliothek zeigt zwei Implementierungen einer Klasse, die Antworten auf das Feedback eines Benutzers generiert. Die erste`BadRefAndOut`Implementierung ( ) zwingt den Bibliotheksbenutzer, drei Rückgabewerte zu verwalten. Die zweite`RedesignedRefAndOut`Implementierung ( ) vereinfacht die Benutzerfreundlichkeit, indem eine`ReplyData`Instanz einer Containerklasse ( zurückgegeben wird, die die Daten als eine einheit verwaltet.

[!code-csharp[FxCop.Design.NoRefOrOut#1](../code-quality/codesnippet/CSharp/ca1021-avoid-out-parameters_1.cs)]

## <a name="example"></a>Beispiel
Die folgende Anwendung veranschaulicht die Benutzererfahrung. Der Aufruf der neu`UseTheSimplifiedClass` gestalteten Bibliothek (Methode) ist einfacher, und die von der Methode zurückgegebenen Informationen werden einfach verwaltet. Die Ausgabe der beiden Methoden ist identisch.

[!code-csharp[FxCop.Design.TestNoRefOrOut#1](../code-quality/codesnippet/CSharp/ca1021-avoid-out-parameters_2.cs)]

## <a name="example"></a>Beispiel
Die folgende Beispielbibliothek `ref` veranschaulicht, wie Parameter für Referenztypen verwendet werden, und zeigt eine bessere Methode zum Implementieren dieser Funktionalität.

[!code-csharp[FxCop.Design.RefByRefNo#1](../code-quality/codesnippet/CSharp/ca1021-avoid-out-parameters_3.cs)]

## <a name="example"></a>Beispiel
Die folgende Anwendung ruft jede Methode in der Bibliothek auf, um das Verhalten zu veranschaulichen.

[!code-csharp[FxCop.Design.TestRefByRefNo#1](../code-quality/codesnippet/CSharp/ca1021-avoid-out-parameters_4.cs)]

Dieses Beispiel erzeugt die folgende Ausgabe:

```txt
Changing pointer - passed by value:
12345
12345
Changing pointer - passed by reference:
12345
12345 ABCDE
Passing by return value:
12345 ABCDE
```

## <a name="try-pattern-methods"></a>Mustermethoden ausprobieren

### <a name="description"></a>BESCHREIBUNG
Methoden, die das **Try\<Something** <xref:System.Int32.TryParse%2A?displayProperty=fullName>>-Muster implementieren, z. B. , führen nicht zu dieser Verletzung. Das folgende Beispiel zeigt eine Struktur (Werttyp), die die <xref:System.Int32.TryParse%2A?displayProperty=fullName> Methode implementiert.

### <a name="code"></a>Code
[!code-csharp[FxCop.Design.TryPattern#1](../code-quality/codesnippet/CSharp/ca1021-avoid-out-parameters_5.cs)]

## <a name="related-rules"></a>Verwandte Regeln
[CA1045: Typen nicht als Verweis übergeben](../code-quality/ca1045.md)
